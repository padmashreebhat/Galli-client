<!DOCTYPE html>
<html lang="en" class="no-js">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
		<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
		<title>Sphinx: HiveInTown</title>
		<meta name="description" content="Sphinx : Galli" />
		<meta name="keywords" content="MyNest Sphinx" />
		<link rel="stylesheet" type="text/css" href="css/tabmenustyle.css" />
		<link rel="stylesheet" href="css/mainmenustyle.css" type="text/css" media="screen"/>
		<link rel="stylesheet" type="text/css" href="css/myselfdefault.css" />
		<link rel="stylesheet" type="text/css" href="css/myselfcomponent.css" />
		<link rel="stylesheet" type="text/css" href="css/default.css" />
		<link rel="stylesheet" type="text/css" href="css/component.css" />
		<link rel="stylesheet" type="text/css" href="css/table.css" />
		<link rel="stylesheet" type="text/css" href="css/customstyles.css" />
		<link rel="stylesheet" type="text/css" href="css/alertbox.css" />
		<link rel="stylesheet" type="text/css" href="css/login.css" />


		<link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
		<script src="//code.jquery.com/jquery-1.10.2.js"></script>
		<script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>

		<script src=js/finance.js></script>
		<script src=js/myflat.js></script>
		<script src=js/database.js></script>
		<script src=js/association.js></script>
		<script src=js/settings.js></script>
		<script src=js/communication.js></script>
		<script src="js/modernizr.custom.js"></script>
		<script src="js/fblogout.js"></script>
		<script src="js/googlelogin.js"></script>
		<script src="js/fblogin.js"></script>
		<script src="js/login.js"></script>
		
		<script src="js/modernizr.custom.js"></script>
		<link rel="stylesheet" type="text/css" href="css/imagegrid.css" />
		<script type="text/javascript" src="js/modernizr.custom.26633.js"></script>
		
		  <style>
            *{
                margin:0;
                padding:0;
              }
              
              #mask {
	display: none;
	background: #000; 
	position: fixed; left: 0; top: 0; 
	z-index: 10;
	width: 100%; height: 100%;
	opacity: 0.8;
	z-index: 999;
}

          </style>

	</head>
	<!-- Place this asynchronous JavaScript just before your </body> tag -->
  <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
  <script type="text/javascript">
  (function() {
    var po = document.createElement('script');
    po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/client:plusone.js?onload=render';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(po, s);
  })();

  function render() {
    gapi.signin.render('customBtn', {
      //'callback': 'signinCallback',
      'clientid': '841077041629.apps.googleusercontent.com',
      'cookiepolicy': 'single_host_origin',
      'requestvisibleactions': 'http://schema.org/AddAction',
      'scope': 'https://www.googleapis.com/auth/plus.login'
    });
  }
  </script>
		<body style="background-image:url(images/background/login.jpg)">
		<h1> HiveInTown </h1>
		    		<div id="LoginInfo" class="UserInfo"> </div>
				<div id="phpout">
	</div>
<!--		<div id="fb-root"></div> -->
			<div id="container" class="container">
			
				<header>
				<div id="statuswin">
		<div class="post" align="right">
        	<div class="btn-sign">
				<a href="#login-box" class="login-window">Sign In</a>
        	</div>
		</div>


<!--				<div
					  class="fb-like"
					  data-send="true"
					  data-width="450"
					  data-show-faces="true" >
					</div>
					  <!-- In the callback, you would hide the gSignInWrapper element on a
	  successful sign in -->
<!---				  <div id="gSignInWrapper">
				    <span class="label"></span>
				    <div id="customBtn" class="customGPlusSignIn">
				      <span class="icon"></span>
				      <span class="buttonText">G</span>
				    </div>
				  </div>
				
				</div>
			--->
			</header>
			<div id="UserInfo" class="UserInfo"> </div>


	<div id="content">
        
        <div id="login-box" class="login-popup">
        	<a href="#" class="close"><img src="images/close_pop.png" class="btn_close" title="Close Window" alt="Close" /></a>
			<form method="post" class="signin" action="#">
                
                			<!----- Facebook Login --------------------------------------------------->
							<fb:login-button scope="public_profile,email" onlogin="checkLoginState();">
							</fb:login-button>
							
							<div id="status">
							</div>
							<br>

							<!----- google Login --------------------------------------------------->
							<button class="g-signin" id="signinButton" onclick="ongooglebuttonclick()"
						        data-scope="https://www.googleapis.com/auth/plus.login"
						        data-clientid="1084232835515-t2tvcifav346l5qo2v58pmp6prlh40uo.apps.googleusercontent.com"
						        data-callback="onSignInCallback"
						        data-theme="dark"
						        data-cookiepolicy="single_host_origin"
						        data-requestvisibleactions="http://schemas.google.com/AddActivity"
						        data-width="wide">
						    </button>
			</br>
                     <div class="btn-sign">
						<a href="#Register" class="login-window">NewUser?</a>
					</div>
                </fieldset>
			</form>			
		</div>
		
        <div id="Register" class="login-popup">
        	<a href="#" class="close"><img src="images/close_pop.png" class="btn_close" title="Close Window" alt="Close" /></a>
			<form method="post" class="signin" action="#">
                <fieldset class="textbox">
	            	<label class="username">
	                <span>User email</span>
	                <input id="email" name="email" value="" type="text" autocomplete="on" placeholder="email"> </br>
	                 <span>First Name</span>
	                <input id="fname" name="fname" value="" type="text" autocomplete="on" placeholder="FirstName">
	                <span>Last Name</span>
	                <input id="lname" name="lname" value="" type="text" autocomplete="on" placeholder="LastName">
	                <span>Apt Num</span>
	                <input id="AptNum" name="AptNum" value="" type="text" autocomplete="on" placeholder="AptNum">
	                </label>
	                <input id="custbutton" type="button" value="Register" onclick="RegiseterUserDetails()"/> 
                </fieldset>
			</form>			
		</div>

    </div>



			<div id="filler-below" class="filler-below">			
			</div>

			<div id="mainmenu">
		           
		    		<div id='security' class="item">
		                <a class="link icon_security"></a>
		                <div class="item_content">
		                    <h2>Security</h2>
		                </div>
		            </div>
		
		            <div id='storage' class="item">
		                <a class="link icon_storage"></a>
		                <div class="item_content">
		                    <h2>Storage</h2>
		                </div>
		            </div>
		            
		            <div id='myself' class="item">
		                <a class="link icon_myflat"></a>
		                <div class="item_content">
		                    <h2>My Apartment</h2>
		                </div>
		            </div> 
		   
		               <div id='database' class="item">
		                <a class="link icon_database"></a>
		                <div class="item_content">
		                    <h2>Database</h2>
		                </div>
		            </div>

		           <div id='settings' class="item">
		                <a class="link icon_settings"></a>
		                <div class="item_content">
		                    <h2>Settings</h2>
		                </div>
		            </div>
		
		              <div id='finance' class="item">
		                <a class="link icon_finance"></a>
		                <div class="item_content">
		                    <h2>Finance</h2>
		                </div>
		            </div>  
		       
		            <div id='association' class="item">
		                <a class="link icon_association"></a>
		                <div class="item_content">
		                    <h2>Association</h2>
		                </div>
		            </div>
		            
		          <div id=communication class="item">
		                <a class="link icon_communication"></a>
		                <div class="item_content">
		                    <h2>Communication</h2>
		                </div>
		            </div>  
		
			</div>
			<div id="submenu">
			
			</div>
		    <div id="QuickViewWin">
				<div class="QuickView" id="Noticeboard">	
					<div class="heading"> <h4> Noticeboard </h4></div>	
					<div class="content"> <table id="nbtable"></table> <p id=NewNb onclick="loadNBdetails()"><a id=QuickViewfont> </a> </p> <br> <p id=Tot>  </p>
					</div>
				</div>
		
				<div class="QuickView" id="SoA" style="background-image:url(images/sealorig.jpg)">	
					<div class="heading"> <h5> Approval </h5></div>	
					<div class="content"> <p id=Open onclick="loadpendingApproval()">  Open: <a id=QuickViewfont> </a> </p> <br> <p id=Tot onclick="loadapprovedrequest()"> Total: <a id=QuickViewfont> </a> </p> </div>
				</div>
				<div class="QuickView" id="Poll" style="background-image:url(images/pollcopy.jpeg)">	
					<div class="heading"> <h5> Poll </h5></div>	
					<div class="content"> <p id=Open onclick="loadopenpolltable()">  Open: <a id=QuickViewfont> </a> </p> <br> <p id=Tot onclick="loadclosepolltable()"> Closed: <a id=QuickViewfont> </a> </p> </div>
				</div>
				<div class="QuickView" id="Bills" style="background-image:url(images/rupeecopy.jpeg)">	
					<div class="heading"> <h5> Bills </h5></div>	
					<div class="content"> <p id=Open onclick="getMsgDetails()">  Pending:<a id=QuickViewfont> </a> </p> <br> <p id=Tot> Old: <a id=QuickViewfont> </a></p> </div>
				</div>
			</div>

		</div>
	
		</body>
</html>


    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
 
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
       <script>

       function hidepopupwin()
       {
	      //$('.container #filler-below').hide();
	      $('#mask , .container #filler-below').fadeOut(300 , function() {
		  	$('#mask').remove();  
		 });
       }
       
	   $('.container #filler-below').hide();

            $('.item').hover(
                function(){
                    var $this = $(this);
                    expand($this);
                },
                function(){
                    var $this = $(this);
                    collapse($this);
                }
            );
            function expand($elem){
                var angle = 0;
                var t = setInterval(function () {
                    if(angle == 1440){
                        clearInterval(t);
                        return;
                    }
                    angle += 40;
                    $('.link',$elem).stop().animate({rotate: '+=-40deg'}, 0);
                },10);
                $elem.stop().animate({width:'200px'}, 1000)
                .find('.item_content').fadeIn(400,function(){
                    $(this).find('p').stop(true,true).fadeIn(600);
                });
            }

            function collapse($elem){
                var angle = 1440;
                var t = setInterval(function () {
                    if(angle == 0){
                        clearInterval(t);
                        return;
                    }
                    angle -= 40;
                    $('.link',$elem).stop().animate({rotate: '+=40deg'}, 0);
                },10);
                $elem.stop().animate({width:'52px'}, 1000)
                .find('.item_content').stop(true,true).fadeOut().find('p').stop(true,true).fadeOut();
            }
 							
 			            function expandsubmenu($elem){
			                var angle = 0;
			                var t = setInterval(function () {
			                    if(angle == 1440){
			                        clearInterval(t);
			                        return;
			                    }
			                    angle += 40;
			                    $('.link',$elem).stop().animate({rotate: '+=-40deg'}, 0);
			                },10);
			                $elem.stop().animate({width:'200px'}, 1000)
			                .find('.item_content').fadeIn(400,function(){
			                    $(this).find('p').stop(true,true).fadeIn(600);
			                });
			            }
			            function collapsesubmenu($elem){
			                var angle = 1440;
			                var t = setInterval(function () {
			                    if(angle == 0){
			                        clearInterval(t);
			                        return;
			                    }
			                    angle -= 40;
			                    $('.link',$elem).stop().animate({rotate: '+=40deg'}, 0);
			                },10);
			                $elem.stop().animate({width:'75px'}, 1000)
			                .find('.item_content').stop(true,true).fadeOut().find('p').stop(true,true).fadeOut();
			            }

							
			var cont = $('#submenu');	
		
			<!---- Load communication Window ----->
			$('.container #mainmenu #communication').click(function(e){ 
			
				cont.load('submenu.html #communication', function(){
				$('.container #submenu #communication #nb').click(function(e){
				loadnoticeboard();
				});		
				$('.container #submenu #communication #sms').click(function(e){
				loadSMS();
				});		
				$('.container #submenu #communication #cb').click(function(e){
				loadcompliantbox();
				});		
				$('.container #submenu #communication #poll').click(function(e){
				loadopinionpoll();
				});		
				 $('.submenuitem').hover(
			                function(){
			                    var $this = $(this);
			                    expandsubmenu($this);
			                },
			                function(){
			                    var $this = $(this);
			                    collapsesubmenu($this);
			                }
			            );

				});
				});

				var cont = $('#submenu');	
			
			<!---- Load database Window ----->
			$('.container #mainmenu #database').click(function(e){ 
				cont.load('submenu.html #database', function(){
				
				$('.container #submenu #database #resident').click(function(e){
				loadresidentwin();
				});		
				$('.container #submenu #database #employee').click(function(e){
				loadSMS();
				});		
				$('.container #submenu #database #housekeeping').click(function(e){
				loadHomeHelper();
				});		
				$('.container #submenu #database #instructor').click(function(e){
				loadInstructorDetails();
				//loadloginscreen();
				});		
				$('.container #submenu #database #serviceprovider').click(function(e){
				loadServiceProvider();
				});		

				 $('.submenuitem').hover(
			                function(){
			                    var $this = $(this);
			                    expandsubmenu($this);
			                },
			                function(){
			                    var $this = $(this);
			                    collapsesubmenu($this);
			                }
			            );
				});
				});
			
			<!---- Load myhome Window ----->
			$('.container #mainmenu #myself').click(function(e){ 
				cont.load('submenu.html #myself', function(){
				$('.container #submenu #myself #family').click(function(e){
				loadmyinfo();
				});		
				$('.container #submenu #myself #Dues').click(function(e){
				});		
				$('.container #submenu #myself #visitors').click(function(e){
				});		


				 $('.submenuitem').hover(
			                function(){
			                    var $this = $(this);
			                    expandsubmenu($this);
			                },
			                function(){
			                    var $this = $(this);
			                    collapsesubmenu($this);
			                }
			            );

				});
				});
			<!---- Load finance Window ----->
			$('.container #mainmenu #finance').click(function(e){ 
				cont.load('submenu.html #finance', function(){
				$('.container #submenu #finance #report').click(function(e){
				});		
				$('.container #submenu #finance #transaction').click(function(e){
				loadfinancedetails();
				});		

				 $('.submenuitem').hover(
			                function(){
			                    var $this = $(this);
			                    expandsubmenu($this);
			                },
			                function(){
			                    var $this = $(this);
			                    collapsesubmenu($this);
			                }
			            );
				});
				});

			<!---- Load settings Window ----->
			$('.container #mainmenu #settings').click(function(e){ 
				loadcreategroup();
				cont.load('submenu.html #settings', function(){
				 $('.submenuitem').hover(
			                function(){
			                    var $this = $(this);
			                    expandsubmenu($this);
			                },
			                function(){
			                    var $this = $(this);
			                    collapsesubmenu($this);
			                }
			            );

				});
				});
				
				<!---- Load Security Window ----->
			$('.container #mainmenu #security').click(function(e){ 
				console.log("inside click");
				cont.load('submenu.html #security', function(){
								           $('.submenuitem').hover(
			                function(){
			                    var $this = $(this);
			                    expandsubmenu($this);
			                },
			                function(){
			                    var $this = $(this);
			                    collapsesubmenu($this);
			                }
			            );
				});
				});

				<!---- Load Association Window ----->
			$('.container #mainmenu #association').click(function(e){ 
				cont.load('submenu.html #association', function(){
				$('.container #submenu #association #seal').click(function(e){
				loadsealofapproval();
				});		
				$('.container #submenu #association #members').click(function(e){
				loadAssociationMem();
				});		
				$('.container #submenu #association #meeting').click(function(e){
				ScheduleMeeting();
				});	

				           $('.submenuitem').hover(
			                function(){
			                    var $this = $(this);
			                    expandsubmenu($this);
			                },
			                function(){
			                    var $this = $(this);
			                    collapsesubmenu($this);
			                }
			            );
				});
				});
				<!---- Load storage Window ----->
			$('.container #mainmenu #storage').click(function(e){ 
				console.log("inside click");
				cont.load('submenu.html #storage', function(){
				           $('.submenuitem').hover(
			                function(){
			                    var $this = $(this);
			                    expandsubmenu($this);
			                },
			                function(){
			                    var $this = $(this);
			                    collapsesubmenu($this);
			                }
			            );
				});
				});

 
</script>
<script>
/*********************************************/
/* Helper javascript functions defined here */
/*********************************************/
function removeLoginWindow(){
	$($('a.login-window').attr('href')).find('div.error').remove(); 	
	$('#mask , .login-popup').fadeOut(300 , function() {
		$('#mask').remove();  
	});
	$('#phpout').empty();
}

function printError(msg,type){
	var errbox = $($('a.login-window').attr('href')).find('div.'+type);
	if( errbox.length == 0 )
	{
		$($('a.login-window').attr('href')).append('<div class='+type+'></div>');			
		errbox = $($('a.login-window').attr('href')).find('div.'+type);
	}
	errbox.text(msg);
}

		$('#LoginInfo').bind('contentchanged', function() {
  // do something after the div content has changed
 // 		var loginid=('#LoginInfo').val();
 var loginid=document.getElementById("LoginInfo").innerHTML;
  		  		verifyUserID(loginid);
  		  		getlatestnbMessages(loginid);
 				$("#QuickViewWin #Noticeboard #NewNb #QuickViewfont").html(QuickViewnb+"<br>");

});


function userinformation(useremail){
	document.getElementById("LoginInfo").innerHTML = useremail;
	$('#LoginInfo').trigger('contentchanged'); 
}

function getuserID(){
useremail=document.getElementById("LoginInfo").innerHTML;
	return useremail;
}

            function verifyUserID(username){
				var loc = location.host;
				var retVal = $.Deferred();
				
				$.getJSON('people.php?username='+username,function(result){
					people = result[0];
					auth = result[1];
			
					console.log('Authentication is '+auth['username']+', '+auth['auth']);
					retVal.resolve(auth['auth']);
					
					//Remove Home page content and update with main menu content 
					$('#ri-grid').hide();
					$('#loginmenu').hide();
					$('#QuickViewWin').show();
					$('#mainmenu').show();
					$('#submenu').show();

					// Process People Object
					$('#phpout').empty();
					for(var i=0; i<people.length; i++){
						$('<div/>').text(people[i].lname).appendTo($('#phpout'));
						$('<div/>').text(people[i].fname).appendTo($('#phpout'));
						$('<div/>').text(people[i].age).appendTo($('#phpout'));
					}
				})
				.done(function( ) {
					console.log( "second success" );
				})
				.fail(function( ) {
			    	console.log( "error" );
			    	return false;
			    })
				.always(function( ) {
			    	console.log( "complete" );
			    });
			    
			    // Return the deferred object for listening
			    return retVal;
			}

/*********************************************/
/* javascript function overrides */
/*********************************************/
$(document).ready(function() {


       $("#mainmenu").hide();
       $("#QuickViewWin").hide();
       /* Get latest messages from database to update Noticeboard */
				var msg=getlatestnbMessages();       
		       	var QuickViewnb = msg;
				$("#QuickViewWin #Noticeboard #NewNb #QuickViewfont").html(QuickViewnb+"<br>");
				
	  /* Get Pending Poll numbers to update QuickView window */
				var TotPollCount=getTotalPollcount();
				var OpenPollCount=getOpenPollcount();
				$("#QuickViewWin #Poll #Open #QuickViewfont").html(TotPollCount+"<br>");
				$("#QuickViewWin #Poll #Tot #QuickViewfont").html(OpenPollCount+"<br>");
				
	  /* Get Pending Bills  update QuickView window */
				var TotPollCount=getTotalPollcount();
				var OpenPollCount=getOpenPollcount();
				$("#QuickViewWin #Bills #Open #QuickViewfont").html(TotPollCount+"<br>");
				$("#QuickViewWin #Bills #Tot #QuickViewfont").html(OpenPollCount+"<br>");

	  /* Get Pending Approvals  update QuickView window */
				var TotPollCount=getTotalPollcount();
				var OpenPollCount=getOpenPollcount();
				$("#QuickViewWin #SoA #Open #QuickViewfont").html(TotPollCount+"<br>");
				$("#QuickViewWin #SoA #Tot #QuickViewfont").html(OpenPollCount+"<br>");


	
	$('a.login-window').click(function() {
			
		// Getting the variable's value from a link 
		var loginBox = $(this).attr('href');

		//Fade in the Popup and add close button
		$(loginBox).fadeIn(300);
		
		//Set the center alignment padding + border
		var popMargTop = ($(loginBox).height() + 24) / 2; 
		var popMargLeft = ($(loginBox).width() + 24) / 2; 
		
		$(loginBox).css({ 
			'margin-top' : -popMargTop,
			'margin-left' : -popMargLeft
		});
		
		// Add the mask to body
		$('body').append('<div id="mask"></div>');
		$('#mask').fadeIn(300);
		
		/*event.preventDefault();*/
	});
	
	// When clicking on the button close or the mask layer the popup closed
	$('a.close').on('click', function() { 
	
		removeLoginWindow();			
		return false;
	});

	$(document).on('click', '#mask', function() {
	
		/*removeLoginWindow();					
		return false;*/
	});

});
</script>
